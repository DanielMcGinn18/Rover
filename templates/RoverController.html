<html>
<head>
  <title>Rover Controller</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> <!-- JQuery link  -->
  <script type="text/javascript" src="{{ url_for('static', filename='js/main.js') }}"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
  <link rel="shortcut icon" href="{{ url_for('static', filename='img/rocket-solid.svg') }}">
</head>
<body onload="requestData()" style="width:960px; margin: 20px auto;">

<!-- Video Stream -->
<aside style="float:right;width:5px;"> <br><br><br><br><br><br>
    <form id="slider2" action="/" method="POST">
      <input type="range" orient="vertical" name="submit" step="5" min="-90" max="90" value="0" id="CameraTilt">
    </form>
</aside>
<aside style="float:right;width:525px;"> 
 <h3><i class="fas fa-video"></i>  Video Feed</h3>
 <img  class="camera-bg" style="width: 41%; height:45%; background-attachment: fixed;" id="bg" class="center" src="{{ url_for('video_feed') }}">
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<!-- Actuator Values -->
 <aside style="float:right;width:262px;">
 <h3><i class="fas fa-wave-square"></i>  Actuators</h3>
 <p><i class="fas fa-fan"></i> <span id="actuator1">Cooling Fan: On  </span>
  <button type="submit" name='Fan' value='True'>Turn Off</button></p>
 <p><i class="fas fa-camera"></i> <span id="actuator2">Camera Tilt Servo: 0&#176;  </span></p>
 <p><i class="fas fa-wave-square"></i> <span id="actuator3">Motor PWM Output: TBD</span></p>
 </aside>
<!-- Sensor Values -->
 <h3><i class="fas fa-tachometer-alt"></i>  Sensors</h3>
 <p><i class="fas fa-satellite-dish"></i>  <span id="sensor1"></span></p>
 <!-- <p><i class="fas fa-thermometer-three-quarters"></i>  <span id="sensor3">Ambient Temp: </span></p> -->
 <p><!-- <i class="fas fa-battery-full"></i>  <span id="sensor5"></span>Battery: 90% --> <i class="fas fa-bolt"></i>  Voltage: 11.3 V</p>
 <p><i class="fas fa-tachometer-alt"></i>  <span id="sensor5"></span>Motor Encoder Speed: TBD</p>

 <h3><i class="fab fa-raspberry-pi"></i>  Computer</h3>
 <p><i class="fas fa-microchip"></i>  <span id="sensor2"></span></p>
 <p><i class="fas fa-wifi"></i>  <span id="wifi">Wifi Network: <i class="fas fa-lock"></i> Hidden</span></p>
 <p><i class="fas fa-server"></i>  <span id="wifi">Server Address: <i class="fas fa-lock"></i> Hidden</span></p>

</aside>

<!-- Connection Status -->

<h1><i class="fas fa-user-astronaut" style="font-size:31px; vertical-align: top;"></i>  Mission Control</h1>
<h4 hidden id = "connected">%s</h4> 
<form action="/" method="POST">
     <span id="dot"></span> <!-- Blink red  -->
     <span id="connectionStatus"></span>
</form>
<script>
  var connected = document.getElementById('connected').innerHTML;
    if (connected == 'True') {
    document.getElementById("dot").className = "dotGreen";
    document.getElementById("connectionStatus").className = "green";
    document.getElementById("connectionStatus").innerHTML = 'Connected';
    document.getElementById("return").style.display = "none";
  } else {
    document.getElementById("dot").className = "dotRed";
    document.getElementById("connectionStatus").className = "red";
    document.getElementById("connectionStatus").innerHTML = 'Houston, we have a problem';
    document.getElementById("return").style.display = "initial";
  }
</script>

<!-- Controls -->
<aside style="float:left;width:320px;">
  <!-- Drive Commands -->
<h3><i class="fas fa-arrows-alt"></i>  Drive Rover</h3>
	<form action="/" method="POST" >
		<center>
			<button type="submit" name='Fwd' value='True' style="font-size:48px"><i class="fa fa-arrow-circle-up"></i></button>
		</center><br>
		<center>
			<button type="submit" name='Left' value='True'style="font-size:48px"><i class="fa fa-arrow-circle-left"></i></button> 
			&nbsp&nbsp
			<button type="submit" name='Stop' value='True' style="font-size:48px"><i class="fa fa-stop-circle"></i></button> 
			&nbsp&nbsp
			<button type="submit" name='Right' value='True' style="font-size:48px"><i class="fa fa-arrow-circle-right"></i></button>
		</center><br>
		<center>
			<button type="submit" name='Bkwd' value='True' style="font-size:48px"><i class="fa fa-arrow-circle-down"></i></button>
		</center>
	</form>
	<form id="slider1" action="/" method="POST">
		<input type="range" name="submit" step="5" min="0" max="100" value="0" class="slider" id="Speed">
		<input hidden id='submitSpeed' type='submit' name='speed' value='True' tabindex='-1'>
	</form>
	<form hidden id='speedForm' action="/" method="POST">
		<input id='speedFormText' type='text' name='Speed' tabindex='-1'>
	</form>
	<center>
		<h4 hidden id='SpeedSetting'>0</h4>
		<h4 id="SpeedText"></h4>
	</center>

  <!-- Control LEDs -->
<h3><i class="far fa-lightbulb"></i>  Control LEDs</h3>
	<form id='ledForm' action="/" method="POST">
	<center>
		<button type="submit" name='Red' value='True' class="buttonRed">Red</button>
		<button type="submit" name='Green' value='True' class="buttonGreen">Green</button>
		<button type="submit" name='Blue' value='True' class="buttonBlue">Blue</button>
	</center>
	</form>
</aside>
<script>
	document.getElementById("Speed").addEventListener("change", submit);
	function submit() {
		document.getElementById('speedFormText').value = 
		document.getElementById('Speed').value 
    	document.getElementById('speedForm').submit();
	} 
	// var slide = document.getElementById('Speed'),
	// slide.onchange = function() {
	// 	document.getElementById('speedSlider').submit();
	// }
    document.getElementById("Speed").value =
    document.getElementById("SpeedSetting").innerHTML;
    document.getElementById("SpeedText").innerHTML = 
    'Speed:'+document.getElementById("SpeedSetting").innerHTML+'/100';
</script>